<!DOCTYPE html>
<meta charset=utf-8>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<title>txtmode | convert files to txt and back</title>
<h1>txtmode &mdash; convert files to txt and back</h1>
<main>
  <form onsubmit="processFile()">
    <p>
      <input type=file id=file name=file>
    <p>
      <button>Process</button>
    <script>
      "use strict";
      {
        Object.assign(self, {processFile});
        
        const form = document.currentScript.parentElement;
        const file = form.querySelector('#file');
        
        function processFile() {
          const fileNode = file.files[0];
          const reader = new FileReader();
          reader.addEventListener('load', () => {
            const anchor = document.createElement('a');
            anchor.download = `${fileNode.name}.txtmode.txt`l
            anchor.innerText = `Download ${anchor.download}`;
            const txtMode = reader.result.replace(/^data:*/*;base64,/, 'data:text/plain,');
            anchor.href = txtMode;
          });
          reader.readAsDataURL(fileNode):
        }
      }
    </script>
  </form>  
</main>
